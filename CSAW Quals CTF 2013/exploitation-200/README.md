## Exploitation-200 Writeup
First we realize that it is a binary that establishes a listening socket by a port we see using <code>iz</code> command with radare2.
<pre><code>[0xb7f1da20]> iz
000 0x00000cf0 0x08048cf0  98  99 (.rodata) ascii Welcome to CSAW CTF.  Exploitation 2 will be a little harder this year.  Insert your exploit here:
001 0x00000d53 0x08048d53   5   6 (.rodata) ascii 31338
002 0x00000d59 0x08048d59   7   8 (.rodata) ascii 0.0.0.0
</code></pre>
Or we can see in <code>main</code> function.
<pre><code>0x0804897a      ba538d0408     mov edx, str.31338          ; 0x8048d53 ; "31338"
0x0804897f      b8598d0408     mov eax, str.0.0.0.0        ; 0x8048d59 ; "0.0.0.0"
</code></pre>
Then we need to establish a connection using netcat to the server that is the vulnerable binary, and also use gdb to attach the process that is running in addition to setting fork mode child and thus stop at our breakpoint and debugging the <code>handle</code> function.
<pre><code>gef➤  !netstat -antp
Active Internet connections (servers and established)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name
tcp        0      0 127.0.1.1:53            0.0.0.0:*               LISTEN      1000/dnsmasq    
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      967/sshd        
tcp        0      0 127.0.0.1:631           0.0.0.0:*               LISTEN      9704/cupsd      
tcp        0      0 0.0.0.0:31338           0.0.0.0:*               LISTEN      11259/exploit2
</code></pre>
We attach the process.
<pre><code>gef➤  attach 11259
gef➤  set follow-fork-mode child
gef➤  b *0x08048850
Breakpoint 2 at 0x8048850: file exploit2.c, line 31.
gef➤  c
Continuing.
</code></pre>
We use netcat to make the connection and just stop at breakpoint. <code>naivenom@ubuntu:~/Desktop/baby/explotation-200$ nc 0.0.0.0 31338</code>. Next we start doing reverse engineering in the <code>handle</code> function so we place a breakpoint in canary self-implementation <code>0x08048850</code> and also after each call to the <code>send</code> function.
